<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Write a lot of Code or PowerShell scripts but are poor at documentation? Here is your solution | Cortana Design</title>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.min.js"
    integrity="sha384-BBtl+eGJRgqQAUMxJ7pMwbEyER4l1g+O15P+16Ep7Q9Q+zqX6gSbd85u4mG4QzX+"
    crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"
    crossorigin="anonymous"></script>
  <script src="https://kit.fontawesome.com/b681124c99.js" crossorigin="anonymous"></script>
  <link rel="icon" href="/assets/images/favicon.ico" type="image/x-icon" />
  <link rel="shortcut icon" href="/assets/images/favicon.ico" type="image/x-icon" />
  <link href="/assets/css/main.css" rel="stylesheet" />
  <link href="/assets/css/rouge-github.css" rel="stylesheet" />
  <link href="/assets/css/custom.css" rel="stylesheet" />

  <link rel="alternate" type="application/atom+xml" title="Cortana Design" href="/feed.xml" />

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Write a lot of Code or PowerShell scripts but are poor at documentation? Here is your solution | Cortana Design</title>
<meta name="generator" content="Jekyll v4.3.4" />
<meta property="og:title" content="Write a lot of Code or PowerShell scripts but are poor at documentation? Here is your solution" />
<meta name="author" content="Trent Steenholdt" />
<meta property="og:locale" content="en_AU" />
<meta name="description" content="We’ve all done it. Spent hours writing the most amazing ARM Template/Bicep file(s) or PowerShell script(s), and it produces nothing but magic. You’re happy; the customer you’ve written it for is happy as you’ve solved their problem. But when it comes to sharing this intellectual property with others in your team, they are now tasked with spending hours reading what you’ve written to even understand it at a basic level! That sounds like their problem, right? NO!" />
<meta property="og:description" content="We’ve all done it. Spent hours writing the most amazing ARM Template/Bicep file(s) or PowerShell script(s), and it produces nothing but magic. You’re happy; the customer you’ve written it for is happy as you’ve solved their problem. But when it comes to sharing this intellectual property with others in your team, they are now tasked with spending hours reading what you’ve written to even understand it at a basic level! That sounds like their problem, right? NO!" />
<link rel="canonical" href="http://localhost:4000/2023/10/19/write-a-lot-of-code-or-powershell-scripts-but-are-poor-at-documentation-here-is-your-solution" />
<meta property="og:url" content="http://localhost:4000/2023/10/19/write-a-lot-of-code-or-powershell-scripts-but-are-poor-at-documentation-here-is-your-solution" />
<meta property="og:site_name" content="Cortana Design" />
<meta property="og:image" content="http://localhost:4000/assets/images/from_wordpress/sigmund-cdMAU_x9mxY-unsplash-scaled.jpg" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2023-10-19T00:00:00+08:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="http://localhost:4000/assets/images/from_wordpress/sigmund-cdMAU_x9mxY-unsplash-scaled.jpg" />
<meta property="twitter:title" content="Write a lot of Code or PowerShell scripts but are poor at documentation? Here is your solution" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Trent Steenholdt"},"dateModified":"2023-10-19T00:00:00+08:00","datePublished":"2023-10-19T00:00:00+08:00","description":"We’ve all done it. Spent hours writing the most amazing ARM Template/Bicep file(s) or PowerShell script(s), and it produces nothing but magic. You’re happy; the customer you’ve written it for is happy as you’ve solved their problem. But when it comes to sharing this intellectual property with others in your team, they are now tasked with spending hours reading what you’ve written to even understand it at a basic level! That sounds like their problem, right? NO!","headline":"Write a lot of Code or PowerShell scripts but are poor at documentation? Here is your solution","image":"http://localhost:4000/assets/images/from_wordpress/sigmund-cdMAU_x9mxY-unsplash-scaled.jpg","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/2023/10/19/write-a-lot-of-code-or-powershell-scripts-but-are-poor-at-documentation-here-is-your-solution"},"publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"http://localhost:4000/assets/images/CortanaDesign-logo.svg"},"name":"Trent Steenholdt"},"url":"http://localhost:4000/2023/10/19/write-a-lot-of-code-or-powershell-scripts-but-are-poor-at-documentation-here-is-your-solution"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body class="d-flex flex-column min-vh-100 bg-light">

  <header>
  <div class="container-fluid text-center">
    <!-- Logo Row -->
    <div class="row mb-3 mt-3">
      <a href="/" title="Cortana Design">
        <img src="/assets/images/cortanadesign.png" alt="Cortana Design Logo" class="img-fluid"
          style="max-height: 155px;">
      </a>
    </div>

    <!-- Buttons Row -->
    <div class="row mb-5">
      <div class="d-flex justify-content-center gap-3">
        <a class="btn btn-dark btn-rounded" href="https://twitter.com/CortannDesign" target="_blank"
          rel="noopener noreferrer" title="Cortana Design on Twitter">
          <i class="fa-brands fa-x-twitter"></i>
          <span class="sr-only">Twitter</span>
        </a>
        <a class="btn btn-linkedin btn-rounded" href="https://www.linkedin.com/company/CortanaDesign/" target="_blank"
          rel="noopener noreferrer" title="Cortana Design on LinkedIn">
          <i class="fa-brands fa-linkedin-in"></i>
          <span class="sr-only">LinkedIn</span>
        </a>
        <a class="btn btn-rss btn-rounded" href="/feed.xml" target="_blank" title="RSS">
          <i class="fa-solid fa-rss"></i>
          <span class="sr-only">RSS</span>
        </a>
        <a class="btn btn-cortana-dark btn-rounded" href="/search" title="Search">
          <i class="fa-solid fa-magnifying-glass"></i>
          <span class="sr-only">Search</span>
        </a>
      </div>
    </div>

    <!-- Blog Title/Description Row -->
    <div class="row mb-2 justify-content-center">
      <div class="col-12 col-md-8 col-lg-6 mx-auto"></div>
      <h3 class="text-center">Trent Steenholdt's Blog</h3>
      <p class="text-center" style="max-width: 550px;">
        A simple blog sharing my findings, interests, and work in the Information Technology industry, as well as
        anything else that interests me.
      </p>
    </div>
  </div>
  </div>
  </div>
</header> <nav class="container-fluid mt-3 d-flex justify-content-center">
  <div class="btn-group" role="group" aria-label="Navigation">
    <a href="/" class="btn btn-cortana-dark btn-lg px-4">Home</a>
    <a href="/author/trentsteenholdt/" class="btn btn-cortana-dark btn-lg px-4">About Me</a>
    <a href="/tags" class="btn btn-cortana-dark btn-lg px-4">Tags</a>
    <a href="https://www.cortanadesign.com.au" class="btn btn-cortana-dark btn-lg px-4">Cortana Design</a>
  </div>
</nav>
  <main><div class="container">
  <article>
    <h1>Write a lot of Code or PowerShell scripts but are poor at documentation? Here is your solution</h1>
    <p class="publish-date">
  
  

  <!-- Profile Image -->
  
  
  
  
  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
  
<p>
  <img class="img-profile-small" src="/assets/images/profile/trentsteenholdt.jpeg" alt="trentsteenholdt" />
  <a rel="author" href="/author/trentsteenholdt" title="Trent Steenholdt">
    Trent Steenholdt
  </a>
  <br />
  October 19, 2023
  
</p>



<!-- No Profile Image -->

<p class="bio">
  
  
  7 minutes to read
  
</p>
</p>
    <div class="tag-container"><span class="tags">Tags: </span><a class="badge bg-CortanaDesign-blue-dark" href="/tags/#documentation">documentation</a><a class="badge bg-CortanaDesign-blue-dark" href="/tags/#psdocs">psdocs</a><a class="badge bg-CortanaDesign-blue-dark" href="/tags/#psrule">psrule</a></div>
    <p>We’ve all done it. Spent hours writing the most amazing ARM Template/Bicep file(s) or PowerShell script(s), and it produces nothing but magic. You’re happy; the customer you’ve written it for is happy as you’ve solved their problem. But when it comes to sharing this intellectual property with others in your team, they are now tasked with spending hours reading what you’ve written to even understand it at a basic level! That sounds like their problem, right? NO!</p>

<p>Documentation is an essential part of any project, whether you’re a developer, a system administrator, or a manager. Well-documented processes, code, and configurations are not only beneficial for the project’s success but also for the overall efficiency of the team. However, writing documentation can be a time-consuming and often tedious task. Thankfully, there’s a solution: <a href="https://github.com/microsoft/PSDocs">PSDocs</a>.</p>

<h2 id="what-is-psdocs">What is PSDocs?</h2>

<p>PSDocs, short for PowerShell Documentation, is a versatile and powerful documentation framework that enables you to automate the creation of documentation for various systems, scripts, configurations, and more. It was created by <a href="https://github.com/BernieWhite">BernieWhite (Bernie White) (github.com)</a> and is designed specifically for PowerShell users or users who are well-versed in Azure, making it a valuable tool for IT professionals, developers, and system administrators.</p>

<h2 id="why-use-it">Why use it?</h2>

<p>PSDocs simplifies the process of creating documentation by automating many of the repetitive and error-prone tasks that typically accompany manual documentation. With automation, you can save time and ensure that your documentation is always up to date. Let’s explore some of the key features that make PSDocs a game-changer.</p>

<h3 id="1-extensive-plugin-support">1. Extensive Plugin Support</h3>

<p>PSDocs offers a wide range of plugins, e.g. <a href="https://azure.github.io/PSDocs.Azure/overview/">PSDocs.Azure</a>, which are sets of rules and templates tailored to specific types of documentation. Whether you need to document your infrastructure, PowerShell scripts, modules, or custom applications, PSDocs has a plugin to suit your needs. This extensibility ensures you can create documentation aligning with your specific requirements without much effort.</p>

<h3 id="2-custom-templates">2. Custom Templates</h3>

<p>With PSDocs, you have the flexibility to create custom templates for your documentation. You can control the layout, formatting, and style to match your organisation’s branding or your personal preferences. Custom templates allow you to create professional and consistent documentation that reflects your unique style.</p>

<h3 id="3-real-time-documentation">3. Real-Time Documentation</h3>

<p>One of the most significant advantages of using PSDocs is the ability to generate documentation in real-time. By running the PSDocs commands, you can obtain the most up-to-date information about your systems, configurations, or scripts. This ensures that your documentation is always current and accurate.</p>

<h3 id="4-continuous-integration-and-deployment-cicd-integration">4. Continuous Integration and Deployment (CI/CD) Integration</h3>

<p>PSDocs can be seamlessly integrated into your CI/CD pipeline. This allows you to automatically update your documentation as changes are made to your systems, code, or configurations, keeping your documentation in sync with your projects.</p>

<h2 id="lets-demo-it">Let’s demo it</h2>

<p>Here is a step-by-step guide to get started with PSDocs and some script snippets to get this added to your existing projects!</p>

<ol>
  <li>
    <p>Open up VS Code and open up your repo project with your various IaC templates and PowerShell scripts.</p>
  </li>
  <li>
    <p>Open up a Powershell terminal and run.</p>
  </li>
</ol>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Install-Module -Name PSDocs -Scope CurrentUser
</code></pre></div></div>

<ol>
  <li>If you want to use PSDocs for your Azure ARM Templates/Bicep Modules, also install</li>
</ol>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Install-Module -Name PSDocs.Azure -Scope CurrentUser
</code></pre></div></div>

<ol>
  <li>Now, in the project root folder, create a ‘ps-docs.yaml’ file in the root. This will be used in your CI/CD pipelines and reference when running the various PowerShell cmdlets. In this file, put the contents of:</li>
</ol>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>configuration:
  AZURE_USE_PARAMETER_FILE_SNIPPET: false
  AZURE_USE_COMMAND_LINE_SNIPPET: true

output:
  culture:
    - 'en-AU'
</code></pre></div></div>

<ol>
  <li>Next, create a top-level folder in the project root called “.ps-docs” with the quotes.</li>
</ol>

<p><a href="/assets/images/from_wordpress/image-29.png"><img src="/assets/images/from_wordpress/image-29.png" alt="" /></a></p>

<ol>
  <li>Inside the “.ps-docs” folder, create your first .ps1 file, which will follow the <a href="https://github.com/microsoft/PSDocs#define-a-document">provided syntax</a> to read any code file you have and produce documentation for you. This file can be for any of your scripts, code templates and files, and its limits are pretty much endless! In the screenshot above, I used PSDocs to read <a href="https://azure.github.io/PSRule.Rules.Azure/setup/configuring-options/">PSRule YAML files</a> and produce the documentation for them. Here is a good starting template to document PSRule YAML configurations:</li>
</ol>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Document PSRule {

    $yamlRaw = (Get-Content -Raw $InputObject.FullName)
    $object = ConvertFrom-Yaml -Yaml $yamlRaw -AllDocuments

    $title = [regex]::Match($yamlRaw, '(?&lt;=Name:\s)(.+)').Groups[1].Value.Trim()
    $description = [regex]::Match($yamlRaw, '(?&lt;=Description:\s)(.+)').Groups[1].Value.Trim()

    if ($title) {
        Title $title # Use title from comment in YAML file
    }
    else {
        Title $InputObject.Name # Use file name
    }

    if ($description) {
        $description # # Use description from comment in YAML file
    }

foreach ($rule in $object) {
        # Add an introduction section
        Section $rule.metadata.name {

            if ($rule.spec.expiresOn) {
                ('This rule will expire on ' + (Get-Date $rule.spec.expiresOn -Format 'yyyy-MM-dd' ) + '. This rule must be re-evaluated, with human intervention, for suitability in this solution as the rule has likely been superseded. Refer to any Azure and PSRule.Rules.Azure documentation for any changes that may have occurred.') | Warning
            }

            $rule.metadata.description

            $properties = @(
                @{ 
                    Name       = 'Rule Name'; 
                    Expression = { $rule.metadata.name } 
                }, 
                @{ 
                    Name       = 'Kind'; 
                    Expression = { $rule.kind } 
                })
        }
}
</code></pre></div></div>

<ol>
  <li>Now, with this config saved, you’re pretty much at the point where you can run the “<a href="https://github.com/microsoft/PSDocs/blob/main/docs/commands/PSDocs/en-US/Invoke-PSDocument.md">Invoke-PSDocument</a>” and output some pretty nifty markdown documentation for the PSRules configuration you have created. But for the sake of completion, here is a simple hardcoded script you can make use of:</li>
</ol>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  $psRulesCustomRulesFolder = $PSRuleDirectoryPaths | ForEach-Object { (Join-Path $PSScriptRoot $_) }
  $psRulesCustomRules = $psRulesCustomRulesFolder | ForEach-Object { Get-ChildItem ($_) -File -Filter *.yaml }
  $psRuleCustomRulesDocsFolder = Join-Path $PSScriptRoot '.\docs\PS-Rule-Doco'

  $allDirectories = $bicepDirectoriesHash.Values.Values + $psRuleCustomRulesDocsFolder
  foreach ($directory in $allDirectories) {
    if (-not(Test-Path $directory -ErrorAction SilentlyContinue)) {
      Write-Host "Directory path not found, creating $directory"
      $pathCreated = New-Item -ItemType Directory -Force -Path $directory
    }
  }  
  foreach ($file in $psRulesCustomRules) {
    $templateName = $file.BaseName
    $out = Invoke-PSDocument -Path $psDocsCustomPSRuleFile -InputObject $file -InstanceName $templateName -OutputPath $psRuleCustomRulesDocsFolder
    if ($out) {
      Write-Host -ForegroundColor Cyan "📃 $($out.Name) - PS Rule documentation created."
    }
    else {
      Write-Host -ForegroundColor Red "❌ $($template.BaseName) - PS Rule documentation creation failed."
    }
  }
</code></pre></div></div>

<p>This script/script block above can be run manually or inside a CI/CD pipeline to produce your documentation as needed.</p>

<p>Example output of General.Rules.YAML files being produced into documentation</p>

<p><a href="/assets/images/from_wordpress/image-30.png"><img src="/assets/images/from_wordpress/image-30-1024x989.png" alt="" /></a></p>

<p>And here is the original YAML file (part of) for reference:</p>

<p><a href="/assets/images/from_wordpress/image-31.png"><img src="/assets/images/from_wordpress/image-31-1024x586.png" alt="" /></a></p>

<h2 id="conclusion">Conclusion</h2>

<p>PSDocs is super damn powerful, and I wish I had known about it years ago! It’s a tool that caan save you a significant amount of time and effort when it comes to documentation. By automating the documentation process, you can ensure that your projects are well-documented, up-to-date, and consistent, freeing up more of your time to focus on the exciting and creative aspects of your work.</p>

<p>Happy documenting!</p>

    <div class="social-share">
  <a href="https://twitter.com/intent/tweet?text=Write a lot of Code or PowerShell scripts but are poor at documentation? Here is your solution&amp;url=http://localhost:4000/2023/10/19/write-a-lot-of-code-or-powershell-scripts-but-are-poor-at-documentation-here-is-your-solution&amp;via=CortanaDesigntechapac"
    class="btn btn-twitter mb-1">
    <i class="fa-brands fa-x-twitter me-1"></i>Share on Twitter (X)
  </a>
  <a href=" https://www.linkedin.com/shareArticle?mini=true&url=http://localhost:4000/2023/10/19/write-a-lot-of-code-or-powershell-scripts-but-are-poor-at-documentation-here-is-your-solution"
    class="btn btn-linkedin mb-1">
    <i class="fa-brands fa-linkedin-in me-1"></i>Share on LinkedIn
  </a>
  <a href="/feed.xml" class="btn btn-rss mb-1">
    <i class="fa-solid fa-rss me-1"></i>RSS Feed
  </a>
</div>
  </article>
</div></main>
  <footer class="footer mt-auto py-3">
  <div class="row">
    <div class="col">
      <p class="small mb-0">© 2025 Cortana Design</p>
    </div>
    <div class="col">
      <ul class="list-inline mb-0">
        <li class="list-inline-item mx-3">
          <a class="small text-white" href="https://www.cortanadesign.com.au">Cortana Design</a>
        </li>
        <li class="list-inline-item mx-3">
          <a class="small text-white" href="https://lainrobertson.wordpress.com/">Lain Robertson's
            Blog</a>
        </li>
      </ul>
    </div>
  </div>
</footer>

  <script src="/assets/js/main.js"></script>
</body>

</html>